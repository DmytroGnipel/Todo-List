(()=>{"use strict";const e={counterId:3,UntilNewYear:[{title:"Losing weight",dueDate:"31.10.2023",description:"in order to have better look on my birthday I want to lose 5 kg until its date",notes:"I want to lose wheigt by restrictings in my diet and conducting active excersises",isComplete:!1,priority:"yellow",id:0,nameProject:"UntilNewYear"},{title:"Learning songs",dueDate:"31.10.2023",description:'I want to perform at the New year"s party and because of that I have to learn at least 5 new songs',notes:"My favorite girl Sara very romatic, so I want learn Ed Sheerans songs about love",isComplete:!1,priority:"red",id:1,nameProject:"UntilNewYear"},{title:"Complete Todo List",dueDate:"31.10.2023",description:"This project from from theodinproject.com is a part of my long javascript journey",notes:"Day when I should finalize the project may be postponed. It depends on circumstances",isComplete:!1,priority:"green",id:2,nameProject:"UntilNewYear"}]},t=(()=>{let t;if(localStorage.getItem("KeeForTodoInStorage")){let e=localStorage.getItem("KeeForTodoInStorage");t=JSON.parse(e)}else t=e;return t})(),n=(e,n,o,c,r,a)=>(a||(a=t.counterId),t.counterId++,{title:e,dueDate:n,description:o,notes:c,priority:"green",isComplete:!1,id:a,nameProject:r}),o=(e,t)=>{t.push(e)},c=(e,n)=>{const o=t[n];for(const t of o)if(t.id==e)return t},r=(e,n)=>{const o=t[n],r=c(e,n),a=o.indexOf(r);o.splice(a,1)},a=(e,n,o)=>{const r=c(e,n),a=t[n].indexOf(r);t[n][a]=o},i=e=>{e.isComplete?e.isComplete=!1:e.isComplete=!0},s=(e,t)=>{e.priority=t},d=()=>{localStorage.setItem("KeeForTodoInStorage",JSON.stringify(t))},l=()=>{const e=new Date((new Date).getFullYear(),(new Date).getMonth()+1,(new Date).getDate()),n=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()+7),o=new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()+1,0,0,0),c=e.getTime()-(new Date).getTime(),r=n.getTime()-(new Date).getTime(),a=o.getTime()-(new Date).getTime(),i=[],s=[],d=[],l=[],u=[],p=[],m=[];for(const e in t)if("counterId"!==e)for(const n of t[e]){const e=n.dueDate.split("."),t=new Date(e[2],e[1]-1,e[0],23,59,59).getTime()-(new Date).getTime();t<c&&t>0&&i.push(n),t<r&&t>0&&s.push(n),t<a&&t>0&&d.push(n),"red"===n.priority&&l.push(n),"yellow"===n.priority&&u.push(n),n.isComplete?p.push(n):m.push(n)}return{month:i,week:s,day:d,red:l,yellow:u,complete:p,uncomplete:m}};function u(){p();const e=document.querySelector(".content");for(const n in t)if("counterId"!==n){const o=document.createElement("div");o.classList.add("projectDiv");const c=document.createElement("h4");c.textContent=n,o.append(c),e.append(o),k(t[n],o);const r=j(n);o.append(r)}}function p(){document.querySelector(".content").innerHTML=""}function m(){const e=document.querySelectorAll(".addTodoButton");for(let c of e)c.addEventListener("click",(function(){const e=this.dataset.projectName;this.remove(),y(4);let c=["title","date","description","notes"];const r=document.querySelectorAll("input[type=text]");for(let e=0;e<4;e++)r[e].placeholder=`${c[e]}`;document.querySelector(".popUp button").addEventListener("click",(function(){let c=n(r[0].value,r[1].value,r[2].value,r[3].value,e);o(c,t[e]),h()}))}))}function f(e){const t=document.querySelectorAll(".editButton");for(const o of t)o.addEventListener("click",(function(){y(4);const t=document.querySelectorAll("input[type=text]"),o=document.querySelectorAll(".popUp p"),r=c(this.dataset.id,this.dataset.projectName);let i=0;for(const e in r)"isComplete"!==e&&"priority"!==e&&"nameProject"!==e&&"id"!==e&&(o[i].textContent=e,t[i].value=r[e],i++);document.querySelector(".popUp button").addEventListener("click",(()=>{const o=n(t[0].value,t[1].value,t[2].value,t[3].value,this.dataset.projectName,this.dataset.id);a(this.dataset.id,this.dataset.projectName,o),e?x(e):h()}))}))}function y(e){const t=document.createElement("div");t.classList.add("popUp");const n=document.querySelector(".content"),o=document.createElement("button");o.textContent="accept";const c=document.createElement("a");c.href="#",c.textContent="X",c.classList.add="closeLink",t.append(c);for(let n=0;n<e;n++){const e=document.createElement("p"),n=document.createElement("input");n.type="text",t.append(e,n)}t.append(o),n.appendChild(t),c.addEventListener("click",(function(){t.remove()}))}function h(){u(),C(),m(),f(),g(),v(),d()}function g(e){const t=document.querySelectorAll("input[type=checkbox]");for(const n of t)n.addEventListener("click",(function(){const t=c(this.dataset.id,this.dataset.projectName);i(t),e?x(e):h()}))}function v(e){const t=document.querySelectorAll("select");for(const n of t)n.addEventListener("change",(function(){const t=c(this.dataset.id,this.dataset.projectName);s(t,`${this.value}`),e?x(e):h()}))}function w(e){const t=document.createElement("button");return t.textContent="Edit todo",t.classList.add("editButton"),t.dataset.projectName=e.nameProject,t.dataset.id=e.id,t}function S(e){const t=document.createElement("button");return t.textContent="Remove todo",t.classList.add("removeButton"),t.dataset.projectName=e.nameProject,t.dataset.id=e.id,t}function j(e){const t=document.createElement("button");return t.textContent="Add new task",t.classList.add("addTodoButton"),t.dataset.projectName=e,t}function E(e){const t=document.createElement("select");t.dataset.projectName=e.nameProject,t.dataset.id=e.id;const n=["Choose a priority","green","yellow","red"];for(let e=0;e<4;e++){const o=document.createElement("option");o.textContent=n[e],o.setAttribute("value",`${n[e]}`),t.append(o)}return t}function D(e){const t=document.createElement("span"),n=document.createElement("label");n.textContent="complete",n.setAttribute("for","iScomplete");const o=document.createElement("input");return o.setAttribute("type","checkbox"),o.setAttribute("id","iScomplete"),o.dataset.projectName=e.nameProject,o.dataset.id=e.id,t.append(n,o),t}function L(e,t){const n=e.isComplete;t.style.textDecoration=n?"line-through":"none",t.style.backgroundColor=e.priority}function k(e,t){for(const n of e){const e=document.createElement("div");e.classList.add("todoDiv");const o=w(n),c=S(n),r=E(n),a=D(n);L(n,e),e.append(n.title," until ",n.dueDate,o,r,a,c),t.append(e)}}function C(e){const t=document.querySelectorAll(".removeButton");for(const n of t)n.addEventListener("click",(function(){r(this.dataset.id,this.dataset.projectName),e?x(e):h()}))}function q(e){document.querySelector(`.${e}`).addEventListener("click",(function(){const t=l()[e];if(!t.length)return document.querySelector(".content").innerHTML="There is no tasks in this directory",void b();p(),b(),k(t,document.querySelector(".content")),C(e),f(e),v(e),g(e)}))}function b(){if(!document.querySelector(".allProjectsLink")){const e=document.createElement("a");e.textContent="Back to all projects",e.classList.add("allProjectsLink"),e.setAttribute("href","#"),document.querySelector(".side").append(e),document.querySelector(".allProjectsLink").addEventListener("click",(function(){this.remove(),h()}))}}function x(e){p(),k(l()[e],document.querySelector(".content")),C(e),f(e),v(e),g(e),d()}u(),document.querySelector(".addProjectLink").addEventListener("click",(function(){y(1);const e=document.querySelector("input[type=text]");e.placeholder="enter a name for new project",document.querySelector(".popUp button").addEventListener("click",(function(){e.value?((e=>{const n=e[0];e.splice(0,1),t[n]=e})((e=>{const t=[];return t[0]=e,t})(e.value)),h()):alert("Your project must to have a name")}))})),m(),f(),g(),v(),C(),q("month"),q("week"),q("day"),q("red"),q("yellow"),q("complete"),q("uncomplete")})();